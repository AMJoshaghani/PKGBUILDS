# Maintainer: joekamprad <joekamprad@endeavouros.com>
pkgname=calamares_config_next_ce
pkgver=1.0
pkgrel=4
pkgdesc='EndeavourOS calamares configuration files for Community Editions'
arch=('any')
url='https://www.endeavouros.com'
license=('GPL3')
source=(
    git+https://github.com/endeavouros-team/calamares_config_next.git#branch=master
    git+https://github.com/EndeavourOS-Community-Editions/calamares-packagechooser.git
)
sha512sums=('SKIP'
            'SKIP')

_caldir=$pkgname/calamares

prepare() {
    mkdir -p $_caldir/modules
    cp    calamares-packagechooser/netinstall-ce-base.yaml                         $_caldir/modules/
    cp    calamares_config_next/calamares/modules/packagechooser.conf              $_caldir/modules/
    cp    calamares_config_next/calamares/modules/contextualprocess.conf           $_caldir/modules/
    cp    calamares_config_next/calamares/modules/netinstall_community-base.conf   $_caldir/modules/
    cp    calamares_config_next/calamares/settings_community.conf                  $_caldir/
    cp -R calamares_config_next/calamares/images                                   $_caldir/
    cp -R calamares_config_next/calamares/ce                                       $_caldir/
}

package() {
    install -dm 755 $pkgdir/etc/calamares
    cp -r --no-preserve=ownership $_caldir $pkgdir/etc/

    rm -rf ../calamares_config_next ../calamares-packagechooser   # cleanup
}

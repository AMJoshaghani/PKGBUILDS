#!/bin/bash

Github2Gitlab() {
    local url="$1"

    source /etc/eos-script-lib-yad.conf       # caller already has done this...

    case "$EOS_FILESERVER_SITE" in
        github)
            echo "$url"
            ;;
        gitlab | *)
            local sed=(
                sed
                -e 's|/raw\.githubusercontent\.com/|/gitlab.com/|'
                -e 's|/github\.com/|/gitlab.com/|'
                -e 's|/endeavouros-team/|/endeavouros-filemirror/|'
                -e 's|/tree/master/|/-/blob/master/|'
                -e 's|/blob/master/|/-/blob/master/|'
                -e 's|/eos-bash-shared$|/eos-apps-info|'
            )
            if [ -n "$(echo "$url" | grep "/raw\.githubusercontent\.com/")" ] ; then
                sed+=(-e 's|/main/|/-/raw/main/|' )
            fi
            echo "$url" | "${sed[@]}"
            ;;
    esac
}

Github2Gitlab "$@"

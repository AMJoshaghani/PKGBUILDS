# Original Maintainer: Gustau Castells <karasu@antergos.com>
# Maintainer: joekamprad <archlinux@kamprad.net>

pkgname=nvidia-installer-dkms
pkgver=3.2
pkgrel=1
pkgdesc="Script to setup nvidia drivers (dkms version) in EndeavourOS"
url="https://github.com/endeavouros-team/PKGBUILDS/raw/master/$pkgname"
arch=('any')
license=('GPL2')
conflicts=(nvidia-installer)
depends=('python' 'nvidia-installer-db' 'dkms' yay)

optdepends=(
  'linux-headers: for nvidia-installer-dkms with kernel linux'
  'linux-lts-headers: for nvidia-installer-dkms with kernel linux-lts'
  'linux-hardened-headers: for nvidia-installer-dkms with kernel linux-hardened'
  'linux-zen-headers: for nvidia-installer-dkms with kernel linux-zen'
)

source=(
  $url/$pkgname
)
sha256sums=('7d4b903ba1b1051c3dff893858c88de6522a98b1bf6eaaaec189036276a70bd8')

package() {
  sed -i $pkgname \
      -e 's|^VERSION = .*$|VERSION = "'$pkgver'"|'
  install -Dm755 $pkgname $pkgdir/usr/bin/$pkgname
}
